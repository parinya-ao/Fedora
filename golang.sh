#!/usr/bin/env bash

# р╕Яр╕▒р╕Зр╕Бр╣Мр╕Кр╕▒р╕Щр╣Бр╕кр╕Фр╕З progress bar р╕нр╕вр╣Ир╕▓р╕Зр╕Зр╣Ир╕▓р╕в (р╣Гр╕Кр╣Йр╣Ар╕Др╕гр╕╖р╣Ир╕нр╕Зр╕лр╕бр╕▓р╕в # р╣Ар╕Ыр╣Зр╕Щр╣Бр╕Цр╕Ър╕Др╕зр╕▓р╕бр╕Др╕╖р╕Ър╕лр╕Щр╣Йр╕▓)
progress_bar() {
  local progress=$1
  local width=40
  local filled=$(( progress * width / 100 ))
  local empty=$(( width - filled ))
  # р╕кр╕гр╣Йр╕▓р╕З string р╕кр╕│р╕лр╕гр╕▒р╕Ър╣Бр╕Чр╣Зр╕Ър╕Др╕зр╕▓р╕бр╕Др╕╖р╕Ър╕лр╕Щр╣Йр╕▓
  local bar=""
  for ((i=0; i<filled; i++)); do bar+="#"; done
  for ((i=0; i<empty; i++)); do bar+="."; done
  printf "\r%3d%% [%s]" "$progress" "$bar"
}

# р╕Яр╕▒р╕Зр╕Бр╣Мр╕Кр╕▒р╕Щр╕Цр╕▓р╕бр╣Гр╕Кр╣И/р╣Др╕бр╣И (yes/no) р╕Ир╕▓р╕Бр╕Ьр╕╣р╣Йр╣Гр╕Кр╣Й
ask_yes_no() {
  local prompt="$1"
  while true; do
    read -rp "$prompt (y/n): " ans
    case "$ans" in
      [Yy]*) return 0 ;;   # yes -> р╕гр╕╡р╣Ар╕Чр╕┤р╕гр╣Мр╕Щ 0 (true)
      [Nn]*) return 1 ;;   # no  -> р╕гр╕╡р╣Ар╕Чр╕┤р╕гр╣Мр╕Щ 1 (false)
      *) echo "р╕Бр╕гр╕╕р╕Ур╕▓р╕Юр╕┤р╕бр╕Юр╣М y р╕лр╕гр╕╖р╕н n." ;;
    esac
  done
}

# 1. р╕Хр╕гр╕зр╕Ир╕кр╕нр╕Ър╕кр╕Цр╕▓р╕Ыр╕▒р╕Хр╕вр╕Бр╕гр╕гр╕бр╕Вр╕нр╕Зр╕гр╕░р╕Ър╕Ъ
echo "ЁЯФН р╕Хр╕гр╕зр╕Ир╕кр╕нр╕Ър╕кр╕Цр╕▓р╕Ыр╕▒р╕Хр╕вр╕Бр╕гр╕гр╕б CPU..."
arch=""
uname_m=$(uname -m)
case "$uname_m" in
  x86_64) arch="amd64" ;;
  aarch64) arch="arm64" ;;
  armv7l) arch="armv6l" ;;  # Go р╣Гр╕Кр╣Йр╕Др╕│р╕зр╣Ир╕▓ armv6l р╕кр╕│р╕лр╕гр╕▒р╕Ъ ARM 32-bit
  *)
    echo "тЭЧ р╕кр╕Цр╕▓р╕Ыр╕▒р╕Хр╕вр╕Бр╕гр╕гр╕б $uname_m р╣Др╕бр╣Ир╕гр╕нр╕Зр╕гр╕▒р╕Ър╣Вр╕Фр╕вр╕кр╕Др╕гр╕┤р╕Ыр╕Хр╣Мр╕Щр╕╡р╣Й"
    echo "р╣Вр╕Ыр╕гр╕Фр╣Бр╕Бр╣Йр╣Др╕Вр╕кр╕Др╕гр╕┤р╕Ыр╕Хр╣Мр╣Ар╕Юр╕╖р╣Ир╕нр╣Ар╕Юр╕┤р╣Ир╕бр╕Бр╕▓р╕гр╕гр╕нр╕Зр╕гр╕▒р╕Ър╕кр╕Цр╕▓р╕Ыр╕▒р╕Хр╕вр╕Бр╕гр╕гр╕бр╕Щр╕╡р╣Й"
    exit 1
    ;;
esac

# 2. р╕Др╣Йр╕Щр╕лр╕▓ URL р╣Др╕Яр╕ер╣М Go р╣Ар╕зр╕нр╕гр╣Мр╕Кр╕▒р╕Щр╕ер╣Ир╕▓р╕кр╕╕р╕Фр╕Чр╕╡р╣Ир╕Хр╕гр╕Зр╕Бр╕▒р╕Ър╕кр╕Цр╕▓р╕Ыр╕▒р╕Хр╕вр╕Бр╕гр╕гр╕б
echo "ЁЯМР р╕Бр╕│р╕ер╕▒р╕Зр╕Др╣Йр╕Щр╕лр╕▓р╣Ар╕зр╕нр╕гр╣Мр╕Кр╕▒р╕Щр╕ер╣Ир╕▓р╕кр╕╕р╕Фр╕Вр╕нр╕З Go р╕кр╕│р╕лр╕гр╕▒р╕Ъ linux-$arch..."
download_page="https://go.dev/dl/"
# р╕Фр╕╢р╕Зр╕Кр╕╖р╣Ир╕нр╣Др╕Яр╕ер╣Мр╕ер╣Ир╕▓р╕кр╕╕р╕Фр╕Чр╕╡р╣Ир╣Ар╕Ыр╣Зр╕Щ goX.Y.Z.linux-ARCH.tar.gz р╕Ир╕▓р╕Бр╕лр╕Щр╣Йр╕▓р╣Ар╕зр╣Зр╕Ъ
filename=$(curl -s "$download_page" | grep -oE "go[0-9]{1,2}\.[0-9]{1,2}(\.[0-9]{1,2})?\.linux-$arch\.tar\.gz" | head -n1)
if [[ -z "$filename" ]]; then
  echo "тЭМ р╣Др╕бр╣Ир╕кр╕▓р╕бр╕▓р╕гр╕Цр╕Хр╕гр╕зр╕Ир╕кр╕нр╕Ър╕Кр╕╖р╣Ир╕нр╣Др╕Яр╕ер╣Мр╕Фр╕▓р╕зр╕Щр╣Мр╣Вр╕лр╕ер╕Фр╕ер╣Ир╕▓р╕кр╕╕р╕Фр╕кр╕│р╕лр╕гр╕▒р╕Ъ $arch р╣Др╕Фр╣Й"
  echo "р╣Вр╕Ыр╕гр╕Фр╕Хр╕гр╕зр╕Ир╕кр╕нр╕Ър╕Бр╕▓р╕гр╣Ар╕Кр╕╖р╣Ир╕нр╕бр╕Хр╣Ир╕нр╕нр╕┤р╕Щр╣Ар╕Чр╕нр╕гр╣Мр╣Ар╕Щр╣Зр╕Хр╕лр╕гр╕╖р╕нр╕гр╕░р╕Ър╕╕р╣Ар╕зр╕нр╕гр╣Мр╕Кр╕▒р╕Щр╣Ар╕нр╕З"
  exit 1
fi
url="https://go.dev/dl/$filename"
echo "тмЗя╕П  р╣Ар╕Хр╕гр╕╡р╕вр╕бр╕Фр╕▓р╕зр╕Щр╣Мр╣Вр╕лр╕ер╕Фр╣Др╕Яр╕ер╣М $filename"
echo "    р╕Ир╕▓р╕Б $url"

# 3. р╕Фр╕▓р╕зр╕Щр╣Мр╣Вр╕лр╕ер╕Фр╣Др╕Яр╕ер╣Мр╕Фр╣Йр╕зр╕вр╕Др╕зр╕▓р╕бр╕Др╕╖р╕Ър╕лр╕Щр╣Йр╕▓
echo "ЁЯУе р╕Бр╕│р╕ер╕▒р╕Зр╕Фр╕▓р╕зр╕Щр╣Мр╣Вр╕лр╕ер╕Ф Go..."
tempfile="$HOME/Downloads/$filename"  # р╕Фр╕▓р╕зр╕Щр╣Мр╣Вр╕лр╕ер╕Фр╕Чр╕╡р╣И ~/Downloads
rm -f "$tempfile"
# р╕Фр╕▓р╕зр╕Щр╣Мр╣Вр╕лр╕ер╕Фр╣Гр╕Щр╕Юр╕╖р╣Йр╕Щр╕лр╕ер╕▒р╕Зр╣Бр╕ер╕░р╣Бр╕кр╕Фр╕З progress bar р╣Бр╕Ър╕Ър╕кр╕╕р╣Ир╕б
curl -L "$url" -o "$tempfile" --silent &
curl_pid=$!
# р╣Бр╕кр╕Фр╕З progress bar р╣Бр╕Ър╕Ър╕кр╕╕р╣Ир╕бр╣Гр╕Щр╕Вр╕Ур╕░р╕Чр╕╡р╣Ир╕Фр╕▓р╕зр╕Щр╣Мр╣Вр╕лр╕ер╕Ф
current=0
while kill -0 $curl_pid 2>/dev/null; do
  # р╕кр╕╕р╣Ир╕бр╕Др╣Ир╕▓ progress р╣Ар╕Юр╕┤р╣Ир╕б 1-15 р╕Хр╣Ир╕нр╕Др╕гр╕▒р╣Йр╕З
  increment=$((RANDOM % 15 + 1))
  current=$((current + increment))
  # р╕Ир╕│р╕Бр╕▒р╕Фр╣Др╕бр╣Ир╣Гр╕лр╣Йр╣Ар╕Бр╕┤р╕Щ 99 р╕Бр╣Ир╕нр╕Щр╕Фр╕▓р╕зр╕Щр╣Мр╣Вр╕лр╕ер╕Фр╣Ар╕кр╕гр╣Зр╕И
  if [ $current -gt 99 ]; then
    current=99
  fi
  progress_bar "$current"
  sleep 0.1
done
# р╕гр╕нр╣Гр╕лр╣Й curl р╣Ар╕кр╕гр╣Зр╕Ир╕кр╕бр╕Ър╕╣р╕гр╕Ур╣М
wait $curl_pid
curl_status=$?
# р╣Бр╕кр╕Фр╕З 100% р╣Ар╕бр╕╖р╣Ир╕нр╣Ар╕кр╕гр╣Зр╕Ир╕кр╕┤р╣Йр╕Щ
progress_bar 100
printf "\n"  # р╕Вр╕╢р╣Йр╕Щр╕Ър╕гр╕гр╕Чр╕▒р╕Фр╣Гр╕лр╕бр╣Ир╕лр╕ер╕▒р╕Зр╕Фр╕▓р╕зр╕Щр╣Мр╣Вр╕лр╕ер╕Фр╣Ар╕кр╕гр╣Зр╕И

# р╕Хр╕гр╕зр╕Ир╕кр╕нр╕Ър╕зр╣Ир╕▓р╕Фр╕▓р╕зр╕Щр╣Мр╣Вр╕лр╕ер╕Фр╕кр╕│р╣Ар╕гр╣Зр╕И (р╣Др╕Яр╕ер╣Мр╕Хр╣Йр╕нр╕Зр╕бр╕╡р╕нр╕вр╕╣р╣Ир╕Ир╕гр╕┤р╕З)
if [ $curl_status -ne 0 ] || [[ ! -f "$tempfile" ]]; then
  echo "тЭМ р╕Фр╕▓р╕зр╕Щр╣Мр╣Вр╕лр╕ер╕Фр╕ер╣Йр╕бр╣Ар╕лр╕ер╕зр╕лр╕гр╕╖р╕нр╕лр╕▓р╣Др╕Яр╕ер╣Мр╕Чр╕╡р╣Ир╕Фр╕▓р╕зр╕Щр╣Мр╣Вр╕лр╕ер╕Фр╣Др╕бр╣Ир╕Юр╕Ъ"
  exit 1
fi

# 4. р╕Цр╕▓р╕бр╕Ьр╕╣р╣Йр╣Гр╕Кр╣Йр╕зр╣Ир╕▓р╕Ир╕░р╕ер╕Ъ /usr/local/go р╣Ар╕Фр╕┤р╕бр╕лр╕гр╕╖р╕нр╣Др╕бр╣И (р╕Цр╣Йр╕▓р╕бр╕╡)
if [[ -d "/usr/local/go" ]]; then
  if ask_yes_no "р╕Юр╕Ър╣Вр╕Яр╕ер╣Ар╕Фр╕нр╕гр╣М /usr/local/go (Go р╣Ар╕зр╕нр╕гр╣Мр╕Кр╕▒р╕Щр╕Бр╣Ир╕нр╕Щр╕лр╕Щр╣Йр╕▓) р╕Хр╣Йр╕нр╕Зр╕Бр╕▓р╕гр╕ер╕Ър╣Ар╕Юр╕╖р╣Ир╕нр╣Бр╕Чр╕Щр╕Чр╕╡р╣Ир╕Фр╣Йр╕зр╕вр╣Ар╕зр╕нр╕гр╣Мр╕Кр╕▒р╕Щр╣Гр╕лр╕бр╣Ир╕лр╕гр╕╖р╕нр╣Др╕бр╣И?"; then
    echo "ЁЯФБ р╕Бр╕│р╕ер╕▒р╕Зр╕ер╕Ъ /usr/local/go р╣Ар╕Бр╣Ир╕▓..."
    sudo rm -rf /usr/local/go || { echo "тЭМ р╕ер╕Ър╣Вр╕Яр╕ер╣Ар╕Фр╕нр╕гр╣Мр╣Ар╕Бр╣Ир╕▓р╣Др╕бр╣Ир╕кр╕│р╣Ар╕гр╣Зр╕И"; exit 1; }
  else
    echo "тЪая╕П  р╣Ар╕Бр╣Зр╕Ър╣Вр╕Яр╕ер╣Ар╕Фр╕нр╕гр╣М /usr/local/go р╣Ар╕Фр╕┤р╕бр╣Др╕зр╣Й (р╕Ир╕░р╕Хр╕┤р╕Фр╕Хр╕▒р╣Йр╕Зр╕Лр╣Йр╕нр╕Щр╕Чр╕▒р╕Ър╕ер╕Зр╣Др╕Ы)"
  fi
fi

# 5. р╣Бр╕Хр╕Бр╣Др╕Яр╕ер╣М tar р╣Др╕Ыр╕вр╕▒р╕З /usr/local
echo "ЁЯУж р╕Бр╕│р╕ер╕▒р╕Зр╕Хр╕┤р╕Фр╕Хр╕▒р╣Йр╕З (р╣Бр╕Хр╕Бр╣Др╕Яр╕ер╣М) р╣Др╕Ыр╕Чр╕╡р╣И /usr/local (р╕Хр╣Йр╕нр╕Зр╣Гр╕Кр╣Й sudo)..."
sudo tar -C /usr/local -xzf "$tempfile" || { echo "тЭМ р╕Бр╕▓р╕гр╣Бр╕Хр╕Бр╣Др╕Яр╕ер╣Мр╕ер╣Йр╕бр╣Ар╕лр╕ер╕з"; exit 1; }

# 6. р╕ер╕Ър╣Др╕Яр╕ер╣М tar р╕Кр╕▒р╣Ир╕зр╕Др╕гр╕▓р╕з
rm -f "$tempfile"

# 7. р╣Ар╕Юр╕┤р╣Ир╕б PATH р╣Бр╕ер╕░р╕Хр╕▒р╕зр╣Бр╕Ыр╕г GOPATH/GOBIN р╣Гр╕Щ config р╕Вр╕нр╕З shell
echo "ЁЯФз р╕Бр╕│р╕ер╕▒р╕Зр╕Хр╕▒р╣Йр╕Зр╕Др╣Ир╕▓р╕Хр╕▒р╕зр╣Бр╕Ыр╕гр╕кр╕ар╕▓р╕Юр╣Бр╕зр╕Фр╕ер╣Йр╕нр╕бр╣Гр╕Щр╣Др╕Яр╕ер╣М config р╕Вр╕нр╕З shell..."
user_shell=""
# р╕Хр╕гр╕зр╕Ир╕кр╕нр╕Ър╕Ир╕▓р╕Бр╕Хр╕▒р╕зр╣Бр╕Ыр╕г SHELL (shell р╕лр╕ер╕▒р╕Бр╕Вр╕нр╕З user) р╕зр╣Ир╕▓р╣Ар╕Ыр╣Зр╕Щ fish, zsh р╕лр╕гр╕╖р╕н bash
case "$(basename "$SHELL")" in
  fish) user_shell="fish" ;;
  zsh) user_shell="zsh" ;;
  bash) user_shell="bash" ;;
  *) user_shell="" ;;
esac

# р╣Др╕Яр╕ер╣М config р╕Хр╕▓р╕бр╕Кр╕Щр╕┤р╕Ф shell
fish_config="$HOME/.config/fish/config.fish"
bash_config="$HOME/.bashrc"
zsh_config="$HOME/.zshrc"

# р╕Ър╕гр╕гр╕Чр╕▒р╕Фр╕Чр╕╡р╣Ир╕Ир╕░р╣Ар╕Юр╕┤р╣Ир╕б
path_line_export='export PATH=$PATH:/usr/local/go/bin'
gopath_line_export='export GOPATH=$HOME/go'
gobin_line_export='export GOBIN=$HOME/go/bin'
path_line_fish='set -gx PATH /usr/local/go/bin $PATH'
gopath_line_fish='set -gx GOPATH $HOME/go'
gobin_line_fish='set -gx GOBIN $GOPATH/bin'

if [[ "$user_shell" == "fish" ]]; then
  # р╕кр╕гр╣Йр╕▓р╕Зр╣Вр╕Яр╕ер╣Ар╕Фр╕нр╕гр╣М config fish р╕Цр╣Йр╕▓р╕вр╕▒р╕Зр╣Др╕бр╣Ир╕бр╕╡
  mkdir -p "$(dirname "$fish_config")"
  # р╣Ар╕Юр╕┤р╣Ир╕бр╕Ър╕гр╕гр╕Чр╕▒р╕Фр╣Гр╕Щ config.fish р╕Цр╣Йр╕▓р╕вр╕▒р╕Зр╣Др╕бр╣Ир╕бр╕╡
  if [[ ! -f "$fish_config" ]] || ! grep -Fq "/usr/local/go/bin" "$fish_config"; then
    echo -e "\n# Go (added by install script)" >> "$fish_config"
    echo "$path_line_fish" >> "$fish_config"
    echo "$gopath_line_fish" >> "$fish_config"
    echo "$gobin_line_fish" >> "$fish_config"
    echo "тЬЕ р╣Ар╕Юр╕┤р╣Ир╕бр╕Бр╕▓р╕гр╕Хр╕▒р╣Йр╕Зр╕Др╣Ир╕▓ PATH/GOPATH р╣Гр╕Щ $fish_config р╣Бр╕ер╣Йр╕з"
  else
    echo "тД╣я╕П р╕Юр╕Ър╕Бр╕▓р╕гр╕Хр╕▒р╣Йр╕Зр╕Др╣Ир╕▓ /usr/local/go/bin р╣Гр╕Щ $fish_config р╕нр╕вр╕╣р╣Ир╣Бр╕ер╣Йр╕з (р╕Вр╣Йр╕▓р╕бр╕Вр╕▒р╣Йр╕Щр╕Хр╕нр╕Щр╣Ар╕Юр╕┤р╣Ир╕б PATH)"
  fi
elif [[ "$user_shell" == "zsh" ]]; then
  if [[ ! -f "$zsh_config" ]] || ! grep -Fq "/usr/local/go/bin" "$zsh_config"; then
    echo -e "\n# Go (added by install script)" >> "$zsh_config"
    echo "$path_line_export" >> "$zsh_config"
    echo "$gopath_line_export" >> "$zsh_config"
    echo "$gobin_line_export" >> "$zsh_config"
    echo "тЬЕ р╣Ар╕Юр╕┤р╣Ир╕бр╕Бр╕▓р╕гр╕Хр╕▒р╣Йр╕Зр╕Др╣Ир╕▓ PATH/GOPATH р╣Гр╕Щ $zsh_config р╣Бр╕ер╣Йр╕з"
  else
    echo "тД╣я╕П р╕Юр╕Ър╕Бр╕▓р╕гр╕Хр╕▒р╣Йр╕Зр╕Др╣Ир╕▓ /usr/local/go/bin р╣Гр╕Щ $zsh_config р╕нр╕вр╕╣р╣Ир╣Бр╕ер╣Йр╕з"
  fi
elif [[ "$user_shell" == "bash" ]]; then
  if [[ ! -f "$bash_config" ]] || ! grep -Fq "/usr/local/go/bin" "$bash_config"; then
    echo -e "\n# Go (added by install script)" >> "$bash_config"
    echo "$path_line_export" >> "$bash_config"
    echo "$gopath_line_export" >> "$bash_config"
    echo "$gobin_line_export" >> "$bash_config"
    echo "тЬЕ р╣Ар╕Юр╕┤р╣Ир╕бр╕Бр╕▓р╕гр╕Хр╕▒р╣Йр╕Зр╕Др╣Ир╕▓ PATH/GOPATH р╣Гр╕Щ $bash_config р╣Бр╕ер╣Йр╕з"
  else
    echo "тД╣я╕П р╕Юр╕Ър╕Бр╕▓р╕гр╕Хр╕▒р╣Йр╕Зр╕Др╣Ир╕▓ /usr/local/go/bin р╣Гр╕Щ $bash_config р╕нр╕вр╕╣р╣Ир╣Бр╕ер╣Йр╕з"
  fi
else
  # р╕Цр╣Йр╕▓р╕Хр╕гр╕зр╕Ир╣Др╕бр╣Ир╕Юр╕Ъ shell р╕Чр╕╡р╣Ир╕гр╕нр╕Зр╕гр╕▒р╕Ъ
  echo "тЪая╕П р╣Др╕бр╣Ир╕кр╕▓р╕бр╕▓р╕гр╕Цр╕Хр╕гр╕зр╕Ир╕Ир╕▒р╕Ъ shell р╕Вр╕нр╕Зр╕Ьр╕╣р╣Йр╣Гр╕Кр╣Йр╣Др╕Фр╣Й р╕лр╕гр╕╖р╕н shell р╣Др╕бр╣Ир╣Гр╕Кр╣И bash/zsh/fish"
  echo "р╣Вр╕Ыр╕гр╕Фр╕Хр╕гр╕зр╕Ир╕кр╕нр╕Ър╣Др╕Яр╕ер╣М config shell р╕Вр╕нр╕Зр╕Др╕╕р╕Ур╕зр╣Ир╕▓р╕бр╕╡р╕Бр╕▓р╕гр╣Ар╕Юр╕┤р╣Ир╕б PATH /usr/local/go/bin р╣Бр╕ер╣Йр╕зр╕лр╕гр╕╖р╕нр╣Др╕бр╣И"
fi

# р╕кр╕гр╣Йр╕▓р╕Зр╣Вр╕Яр╕ер╣Ар╕Фр╕нр╕гр╣М $HOME/go/bin р╕Цр╣Йр╕▓р╕вр╕▒р╕Зр╣Др╕бр╣Ир╕бр╕╡ (р╕кр╕│р╕лр╕гр╕▒р╕Ъ GOBIN)
mkdir -p "$HOME/go/bin"

# 8. р╣Вр╕лр╕ер╕Фр╣Др╕Яр╕ер╣М config (р╕кр╕│р╕лр╕гр╕▒р╕Ъ shell р╕Ыр╕▒р╕Ир╕Ир╕╕р╕Ър╕▒р╕Щ) р╣Ар╕Юр╕╖р╣Ир╕нр╣Гр╕лр╣Йр╕Др╣Ир╕▓р╕Чр╕╡р╣Ир╣Ар╕Юр╕┤р╣Ир╕бр╕бр╕╡р╕Ьр╕ер╕Чр╕▒р╕Щр╕Чр╕╡
if [[ "$user_shell" == "fish" && -f "$fish_config" ]]; then
  echo "ЁЯФБ р╕Бр╕│р╕ер╕▒р╕Зр╣Вр╕лр╕ер╕Ф $fish_config р╣Ар╕Юр╕╖р╣Ир╕нр╣Гр╕лр╣Йр╕Др╣Ир╕▓ PATH р╕бр╕╡р╕Ьр╕е..."
  # р╣Ар╕гр╕╡р╕вр╕Б fish р╣Ар╕Юр╕╖р╣Ир╕н source config.fish
  fish -c "source $fish_config"
elif [[ "$user_shell" == "zsh" && -f "$zsh_config" ]]; then
  echo "ЁЯФБ р╕Бр╕│р╕ер╕▒р╕Зр╣Вр╕лр╕ер╕Ф $zsh_config р╣Ар╕Юр╕╖р╣Ир╕нр╣Гр╕лр╣Йр╕Др╣Ир╕▓ PATH р╕бр╕╡р╕Ьр╕е..."
  # р╣Вр╕лр╕ер╕Ф config zsh р╣Гр╕Щр╣Ар╕Кр╕ер╕ер╣Мр╕вр╣Ир╕нр╕в
  zsh -c "source $zsh_config"
elif [[ "$user_shell" == "bash" && -f "$bash_config" ]]; then
  echo "ЁЯФБ р╕Бр╕│р╕ер╕▒р╕Зр╣Вр╕лр╕ер╕Ф $bash_config р╣Ар╕Юр╕╖р╣Ир╕нр╣Гр╕лр╣Йр╕Др╣Ир╕▓ PATH р╕бр╕╡р╕Ьр╕е..."
  # р╣Гр╕Кр╣Й source р╣Гр╕Щ subshell bash
  source "$bash_config"
fi

# 9. р╕Хр╕гр╕зр╕Ир╕кр╕нр╕Ър╣Ар╕зр╕нр╕гр╣Мр╕Кр╕▒р╕Щр╕Вр╕нр╕З Go р╕Чр╕╡р╣Ир╕Хр╕┤р╕Фр╕Хр╕▒р╣Йр╕З
if command -v go >/dev/null 2>&1; then
  go_ver=$(go version)
  echo "ЁЯОЙ р╕Бр╕▓р╕гр╕Хр╕┤р╕Фр╕Хр╕▒р╣Йр╕Зр╣Ар╕кр╕гр╣Зр╕Ир╕кр╕┤р╣Йр╕Щ! р╕Хр╕┤р╕Фр╕Хр╕▒р╣Йр╕З $go_ver р╣Ар╕гр╕╡р╕вр╕Ър╕гр╣Йр╕нр╕в"
else
  echo "тЭЧ р╣Др╕бр╣Ир╕Юр╕Ър╕Др╕│р╕кр╕▒р╣Ир╕З 'go' р╣Гр╕Щ PATH р╣Вр╕Ыр╕гр╕Фр╕ер╕нр╕Зр╣Ар╕Ыр╕┤р╕Фр╣Ар╕Чр╕нр╕гр╣Мр╕бр╕┤р╕Щр╕▒р╕ер╣Гр╕лр╕бр╣Ир╕лр╕гр╕╖р╕нр╕гр╕▒р╕Щ 'source' р╣Др╕Яр╕ер╣М config"
fi
